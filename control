<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO & Social Sharing -->
    <title>Nazim Mubin | Official Links</title>
    <meta name="description" content="Official links, latest music, and videos from Nazim Mubin.">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Nazim Mubin | New Music Out Now">
    <meta property="og:description" content="Listen to the latest tracks and watch official videos.">
    <meta property="og:image" content="https://ui-avatars.com/api/?name=Nazim+Mubin&background=6366f1&color=fff&size=512">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- CONFIGURATION ---
        const firebaseConfig = JSON.parse(localStorage.getItem('firebase_config_override') || JSON.stringify({
             // In a real deployment, you would replace these with your own Firebase keys
             // For this preview environment, the system provides them automatically.
             apiKey: "AIzaSy...",
             authDomain: "project.firebaseapp.com",
             projectId: "project",
        }));
        
        // System variables for the preview environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'nazim-music-app';
        // If we are in the previewer, use the system config
        const activeConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : firebaseConfig;

        const app = initializeApp(activeConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- STATE MANAGEMENT ---
        let currentUser = null;
        let siteData = {
            // DEFAULT DATA (Used if database is empty)
            youtubeVideoId: "8teszBXo9zg",
            newRelease: {
                title: "Aaja Heeriye",
                type: "New Single",
                appleLink: "https://music.apple.com/us/album/aaja-heeriye-single/1857156505",
                ytMusicLink: "https://music.youtube.com/watch?v=RYFV15aYEG4",
            },
            spotifyTrackId: "0VPdtAOwfk4tKJYSAOX9vA",
            spotifyArtistId: "3AeJN7kI13TEa7ItCJ9s6P",
            youtubeChannel: "https://www.youtube.com/@nazimxmubin",
            bio: {
                text: "Nazim Mubin is a passionate musical artist creating soulful melodies and engaging content.",
                imageUrl: "https://ui-avatars.com/api/?name=Nazim+Mubin&background=6366f1&color=fff&size=256"
            }
        };

        // --- AUTH & DATA SYNC ---
        async function init() {
            try {
                await signInAnonymously(auth);
                
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        currentUser = user;
                        subscribeToData();
                    }
                });
            } catch (error) {
                console.error("Auth error:", error);
            }
        }

        function subscribeToData() {
            // LISTENER: Updates UI whenever database changes
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site_content');
            
            onSnapshot(docRef, (docSnap) => {
                if (docSnap.exists()) {
                    siteData = { ...siteData, ...docSnap.data() };
                    renderPublicView();
                    fillAdminForm(); // Update admin inputs if they are open
                } else {
                    // If no data exists yet, save the defaults so we have something to edit
                    saveData(siteData); 
                    renderPublicView();
                }
            }, (error) => {
                console.error("Data fetch error:", error);
                // Fallback to render defaults on error
                renderPublicView();
            });
        }

        // --- RENDER LOGIC ---
        function renderPublicView() {
            // Update YouTube Video
            document.getElementById('hero-video').src = `https://www.youtube.com/embed/${siteData.youtubeVideoId}?si=default`;
            
            // Update New Release Card
            document.getElementById('nr-title').textContent = siteData.newRelease.title;
            document.getElementById('nr-badge').textContent = siteData.newRelease.type;
            document.getElementById('nr-apple').href = siteData.newRelease.appleLink;
            document.getElementById('nr-ytmusic').href = siteData.newRelease.ytMusicLink;
            
            // Update Spotify Track
            document.getElementById('spotify-track-frame').src = `https://open.spotify.com/embed/track/${siteData.spotifyTrackId}?utm_source=generator&theme=0`;
            
            // Update Spotify Follow
            document.getElementById('spotify-follow-link').href = `https://open.spotify.com/artist/${siteData.spotifyArtistId}`;
            
            // Update YouTube Subscribe
            document.getElementById('yt-subscribe-link').href = siteData.youtubeChannel;
            
            // Update Bio
            document.getElementById('bio-text').textContent = siteData.bio.text;
            document.getElementById('bio-img').src = siteData.bio.imageUrl;
            
            document.getElementById('loading-overlay').classList.add('hidden');
        }

        // --- ADMIN LOGIC ---
        window.toggleAdmin = function() {
            const panel = document.getElementById('admin-panel');
            const pass = prompt("Enter Admin Password:");
            if(pass === "nazim123") { // Simple client-side check
                panel.classList.remove('hidden');
                fillAdminForm();
                // Scroll to admin panel
                panel.scrollIntoView({ behavior: 'smooth' });
            } else {
                alert("Incorrect password");
            }
        };
        
        window.closeAdmin = function() {
            document.getElementById('admin-panel').classList.add('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function fillAdminForm() {
            document.getElementById('inp-yt-video').value = siteData.youtubeVideoId;
            document.getElementById('inp-nr-title').value = siteData.newRelease.title;
            document.getElementById('inp-nr-type').value = siteData.newRelease.type;
            document.getElementById('inp-nr-apple').value = siteData.newRelease.appleLink;
            document.getElementById('inp-nr-ytmusic').value = siteData.newRelease.ytMusicLink;
            document.getElementById('inp-sp-track').value = siteData.spotifyTrackId;
            document.getElementById('inp-sp-artist').value = siteData.spotifyArtistId;
            document.getElementById('inp-bio-text').value = siteData.bio.text;
            document.getElementById('inp-bio-img').value = siteData.bio.imageUrl;
        }

        window.saveChanges = async function() {
            const btn = document.getElementById('save-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Saving...';
            
            const newData = {
                youtubeVideoId: document.getElementById('inp-yt-video').value,
                newRelease: {
                    title: document.getElementById('inp-nr-title').value,
                    type: document.getElementById('inp-nr-type').value,
                    appleLink: document.getElementById('inp-nr-apple').value,
                    ytMusicLink: document.getElementById('inp-nr-ytmusic').value,
                },
                spotifyTrackId: document.getElementById('inp-sp-track').value,
                spotifyArtistId: document.getElementById('inp-sp-artist').value,
                youtubeChannel: siteData.youtubeChannel, // Keeping static for now or add input
                bio: {
                    text: document.getElementById('inp-bio-text').value,
                    imageUrl: document.getElementById('inp-bio-img').value
                }
            };

            try {
                await saveData(newData);
                btn.innerHTML = '<i class="fa-solid fa-check"></i> Saved!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    closeAdmin();
                }, 1500);
            } catch (e) {
                console.error(e);
                alert("Error saving data. See console.");
                btn.innerHTML = originalText;
            }
        };

        async function saveData(data) {
            if (!currentUser) return;
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site_content');
            await setDoc(docRef, data);
        }

        // Start App
        init();
    </script>
    
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
            min-height: 100vh;
        }

        /* Bento Grid & Animations */
        .bento-card {
            background: white;
            border-radius: 24px;
            border: 1px solid #e2e8f0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .bento-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
            z-index: 10;
        }

        .bg-pattern-1 { background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%); }
        .bg-pattern-2 { background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%); }

        /* Loading Overlay */
        #loading-overlay {
            position: fixed; inset: 0; background: white; z-index: 100;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.5s;
        }
        #loading-overlay.hidden { opacity: 0; pointer-events: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 pb-20">

    <!-- LOADING SCREEN -->
    <div id="loading-overlay">
        <div class="animate-pulse flex flex-col items-center">
            <div class="w-16 h-16 bg-indigo-100 rounded-full mb-4 flex items-center justify-center">
                <i class="fa-solid fa-music text-indigo-500 text-2xl"></i>
            </div>
            <div class="h-4 w-32 bg-slate-200 rounded"></div>
        </div>
    </div>

    <!-- HEADER -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-200 px-6 py-4 mb-8">
        <div class="max-w-3xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 p-[2px]">
                    <div class="w-full h-full rounded-full bg-white flex items-center justify-center">
                        <span class="font-bold text-xs">NM</span>
                    </div>
                </div>
                <h1 class="font-bold text-lg tracking-tight">Nazim Mubin</h1>
            </div>
            <div class="flex gap-4 text-lg text-slate-400">
                <a href="https://www.youtube.com/@nazimxmubin" class="hover:text-red-600 transition-colors"><i class="fa-brands fa-youtube"></i></a>
                <a href="https://instagram.com" class="hover:text-pink-600 transition-colors"><i class="fa-brands fa-instagram"></i></a>
            </div>
        </div>
    </header>

    <!-- PUBLIC CONTENT -->
    <main class="max-w-3xl mx-auto px-4 space-y-8">

        <!-- LATEST VIDEO -->
        <div class="w-full">
            <div class="flex items-center justify-between mb-3 px-1">
                <h2 class="font-bold text-xl text-slate-800">Latest Video</h2>
                <span class="text-xs font-semibold bg-red-100 text-red-600 px-2 py-1 rounded-full animate-pulse">LIVE NOW</span>
            </div>
            <div class="bento-card w-full aspect-video shadow-xl ring-4 ring-white">
                <iframe 
                    id="hero-video"
                    class="w-full h-full object-cover"
                    src="" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen>
                </iframe>
            </div>
        </div>

        <!-- DISCOGRAPHY -->
        <div>
            <h2 class="font-bold text-xl text-slate-800 mb-4 px-1">Music & Connect</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

                <!-- New Release -->
                <div class="bento-card p-5 flex flex-col justify-between h-64 bg-white relative">
                    <div id="nr-badge" class="absolute top-0 right-0 bg-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-bl-xl z-20">
                        NEW SINGLE
                    </div>
                    <div class="flex items-start gap-4 z-10">
                        <div class="w-20 h-20 rounded-xl bg-pattern-1 shadow-md shrink-0 flex items-center justify-center text-white/50 text-2xl">
                            <i class="fa-solid fa-music"></i>
                        </div>
                        <div>
                            <h3 id="nr-title" class="font-bold text-lg leading-tight mb-1">Loading...</h3>
                            <p class="text-sm text-slate-500">Nazim Mubin</p>
                            <p class="text-xs text-indigo-500 mt-2 font-medium">Out Now</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mt-4 z-10">
                        <a id="nr-apple" href="#" target="_blank" class="flex items-center justify-center gap-2 bg-slate-50 hover:bg-pink-50 text-slate-700 hover:text-pink-600 py-3 rounded-xl transition-colors border border-slate-200">
                            <i class="fa-brands fa-apple text-lg"></i> <span class="text-sm font-semibold">Apple</span>
                        </a>
                        <a id="nr-ytmusic" href="#" target="_blank" class="flex items-center justify-center gap-2 bg-slate-50 hover:bg-red-50 text-slate-700 hover:text-red-600 py-3 rounded-xl transition-colors border border-slate-200">
                            <i class="fa-solid fa-circle-play text-lg"></i> <span class="text-sm font-semibold">Music</span>
                        </a>
                    </div>
                </div>

                <!-- Spotify Embed -->
                <div class="bento-card p-0 h-64 relative overflow-hidden">
                    <div class="absolute inset-0 bg-pattern-2 opacity-30"></div>
                    <div class="relative z-10 h-full flex flex-col p-5">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg text-slate-800">Popular Track</h3>
                            <p class="text-sm text-slate-500">Listen on Spotify</p>
                        </div>
                        <div class="w-full rounded-xl overflow-hidden shadow-sm mt-auto">
                            <iframe id="spotify-track-frame" style="border-radius:12px" src="" width="100%" height="100" frameBorder="0" allowfullscreen="" loading="lazy"></iframe>
                        </div>
                    </div>
                </div>

                <!-- Spotify Follow -->
                <a id="spotify-follow-link" href="#" target="_blank" class="bento-card h-64 flex flex-col items-center justify-center p-6 text-center bg-[#1DB954] text-white hover:bg-[#1ed760] border-none">
                    <div class="w-16 h-16 rounded-full bg-black/20 flex items-center justify-center mb-4">
                        <i class="fa-brands fa-spotify text-3xl"></i>
                    </div>
                    <h3 class="font-bold text-2xl">Follow</h3>
                    <p class="text-white/80 text-sm mt-2">Stream full discography</p>
                </a>

                <!-- Youtube Subscribe -->
                <a id="yt-subscribe-link" href="#" target="_blank" class="bento-card h-64 flex flex-col items-center justify-center p-6 text-center bg-slate-900 text-white hover:bg-[#FF0000] border-none">
                    <div class="w-16 h-16 rounded-full bg-white/10 flex items-center justify-center mb-4">
                        <i class="fa-brands fa-youtube text-3xl"></i>
                    </div>
                    <h3 class="font-bold text-2xl">Subscribe</h3>
                    <p class="text-white/60 text-sm mt-2">Official Channel</p>
                </a>

            </div>
        </div>

        <!-- BIO -->
        <div class="w-full bg-white rounded-3xl border border-e2e8f0 p-6 md:p-8 shadow-sm">
            <h2 class="font-bold text-xl text-slate-800 mb-6">About Nazim</h2>
            <div class="flex flex-col md:flex-row gap-8 items-center md:items-start">
                <div class="w-32 h-32 md:w-48 md:h-48 rounded-full md:rounded-2xl bg-slate-200 shrink-0 overflow-hidden shadow-inner border-4 border-slate-50">
                    <img id="bio-img" src="" alt="Nazim Mubin" class="w-full h-full object-cover">
                </div>
                <div class="flex-1 text-center md:text-left space-y-4">
                    <p id="bio-text" class="text-slate-600 leading-relaxed"></p>
                    <div class="pt-2">
                        <span class="font-handwriting text-indigo-500 font-semibold text-lg italic">~ Nazim Mubin</span>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- FOOTER & ADMIN TRIGGER -->
    <footer class="py-8 text-center border-t border-slate-200 mt-8">
        <p class="text-slate-400 text-sm">Â© 2025 Nazim Mubin. All rights reserved.</p>
        <button onclick="toggleAdmin()" class="mt-4 text-xs text-slate-300 hover:text-slate-500 transition-colors uppercase tracking-widest">
            Admin Login
        </button>
    </footer>

    <!-- ADMIN PANEL (Hidden by Default) -->
    <div id="admin-panel" class="hidden fixed inset-0 z-[100] bg-slate-900/95 backdrop-blur-sm overflow-y-auto p-4 md:p-8">
        <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
            <div class="bg-indigo-600 px-6 py-4 flex justify-between items-center">
                <h2 class="text-white font-bold text-lg"><i class="fa-solid fa-sliders mr-2"></i> Control Page</h2>
                <button onclick="closeAdmin()" class="text-white/80 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Video Section -->
                <div class="space-y-2">
                    <label class="block text-xs font-bold text-slate-500 uppercase">YouTube Video ID</label>
                    <input id="inp-yt-video" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg font-mono text-sm" placeholder="e.g. 8teszBXo9zg">
                    <p class="text-[10px] text-slate-400">The code after v= in the youtube URL.</p>
                </div>

                <hr class="border-slate-100">

                <!-- New Release Section -->
                <div class="space-y-4">
                    <h3 class="font-bold text-slate-800">New Release Card</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="block text-xs font-bold text-slate-500 uppercase">Song Title</label>
                            <input id="inp-nr-title" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg">
                        </div>
                        <div class="space-y-2">
                            <label class="block text-xs font-bold text-slate-500 uppercase">Badge Type</label>
                            <input id="inp-nr-type" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg" placeholder="e.g. NEW SINGLE">
                        </div>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">Apple Music Link</label>
                        <input id="inp-nr-apple" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">YouTube Music Link</label>
                        <input id="inp-nr-ytmusic" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg">
                    </div>
                </div>

                <hr class="border-slate-100">

                <!-- Spotify IDs -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">Spotify Track ID</label>
                        <input id="inp-sp-track" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg font-mono text-sm">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">Spotify Artist ID</label>
                        <input id="inp-sp-artist" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg font-mono text-sm">
                    </div>
                </div>

                <hr class="border-slate-100">

                <!-- Bio Section -->
                <div class="space-y-4">
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">Profile Image URL</label>
                        <input id="inp-bio-img" type="text" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase">Bio Text</label>
                        <textarea id="inp-bio-text" rows="4" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg"></textarea>
                    </div>
                </div>

                <button id="save-btn" onclick="saveChanges()" class="w-full bg-indigo-600 text-white font-bold py-4 rounded-xl hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

</body>
</html>
